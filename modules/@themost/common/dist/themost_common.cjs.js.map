{"version":3,"file":"themost_common.cjs.js","sources":["../src/emitter.js","../src/http-error-codes.js","../src/errors.js","../src/utils.js","../src/config.js","../src/html.js","../src/app.js"],"sourcesContent":["/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\n \r\nimport {EventEmitter} from 'events';\r\nimport {applyEachSeries} from 'async';\r\n\r\n/**\r\n * @classdesc SequentialEventEmitter class is an extension of node.js EventEmitter class where listeners are executing in series.\r\n * @class\r\n * @constructor\r\n * @augments EventEmitter\r\n */\r\nexport class SequentialEventEmitter extends EventEmitter {\r\n    /**\r\n     * Executes event listeners in series.\r\n     * @param {String} event - The event that is going to be executed.\r\n     * @param {...*} args - An object that contains the event arguments.\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    // tslint:disable-nex-lineb no-unused-variable\r\n    emit(event, _args) {\r\n        //ensure callback\r\n        callback = callback || (() => {});\r\n        //get listeners\r\n        if (typeof this.listeners !== 'function') {\r\n            throw new Error('undefined listeners');\r\n        }\r\n        const listeners = this.listeners(event);\r\n\r\n        const argsAndCallback = [].concat(Array.prototype.slice.call(arguments, 1));\r\n        if (argsAndCallback.length > 0) {\r\n            //check the last argument (expected callback function)\r\n            if (typeof argsAndCallback[argsAndCallback.length - 1] !== \"function\") {\r\n                throw new TypeError(\"Expected event callback\");\r\n            }\r\n        }\r\n        //get callback function (the last argument of arguments list)\r\n        const callback = argsAndCallback[argsAndCallback.length - 1];\r\n\r\n        //validate listeners\r\n        if (listeners.length===0) {\r\n            //exit emitter\r\n            return callback();\r\n        }\r\n        //apply each series\r\n        return applyEachSeries.apply(this, [listeners].concat(argsAndCallback));\r\n    }\r\n}\r\n","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\n \r\nconst Errors = [{\r\n    statusCode: 400,\r\n    title: \"Bad Request\",\r\n    message: \"The request cannot be fulfilled due to bad syntax.\"\r\n}, {\r\n    statusCode: 401,\r\n    title: \"Unauthorized\",\r\n    message: \"The request was a legal request, but requires user authentication.\"\r\n}, {\r\n    statusCode: 403,\r\n    title: \"Forbidden\",\r\n    message: \"The server understood the request, but is refusing to fulfill it.\"\r\n}, {\r\n    statusCode: 404,\r\n    title: \"Not Found\",\r\n    message: \"The requested resource could not be found but may be available again in the future.\"\r\n}, {\r\n    statusCode: 405,\r\n    title: \"Method Not Allowed\",\r\n    message: \"A request was made of a resource using a request method not supported by that resource.\"\r\n}, {\r\n    statusCode: 406,\r\n    title: \"Not Acceptable\",\r\n    message: \"The requested resource is only capable of generating content not acceptable according to the Accept headers sent in the request.\"\r\n}, {\r\n    statusCode: 407,\r\n    title: \"Proxy Authentication Required\",\r\n    message: \"The client must first authenticate itself with the proxy.\"\r\n}, {\r\n    statusCode: 408,\r\n    title: \"Request Timeout\",\r\n    message: \"The server timed out waiting for the request.\"\r\n}, {\r\n    statusCode: 409,\r\n    title: \"Conflict\",\r\n    message: \"The request could not be completed due to a conflict with the current state of the resource.\"\r\n}, {\r\n    statusCode: 410,\r\n    title: \"Gone\",\r\n    message: \"The resource requested is no longer available and will not be available again.\"\r\n}, {\r\n    statusCode: 411,\r\n    title: \"Length Required\",\r\n    message: \"The request did not specify the length of its content, which is required by the requested resource.\"\r\n}, {\r\n    statusCode: 412,\r\n    title: \"Precondition Failed\",\r\n    message: \"The server does not meet one of the preconditions that the requester put on the request.\"\r\n}, {\r\n    statusCode: 413,\r\n    title: \"Request Entity Too Large\",\r\n    message: \"The request is larger than the server is willing or able to process.\"\r\n}, {\r\n    statusCode: 414,\r\n    title: \"Request-URI Too Long\",\r\n    message: \"The URI provided was too long for the server to process.\"\r\n}, {\r\n    statusCode: 415,\r\n    title: \"Unsupported Media Type\",\r\n    message: \"The server is refusing to service the request because the payload is in a format not supported by this method on the target resource.\"\r\n}, {\r\n    statusCode: 416,\r\n    title: \"Requested Range Not Satisfiable\",\r\n    message: \"The client has asked for a portion of the file, but the server cannot supply that portion.\"\r\n}, {\r\n    statusCode: 417,\r\n    title: \"Expectation Failed\",\r\n    message: \"The server cannot meet the requirements of the Expect request-header field.\"\r\n}, {\r\n    statusCode: 496,\r\n    title: \"No Cert\",\r\n    message: \"The client must provide a certificate to fulfill the request.\"\r\n}, {\r\n    statusCode: 498,\r\n    title: \"Token expired\",\r\n    message: \"Token was expired or is in invalid state.\"\r\n}, {\r\n    statusCode: 499,\r\n    title: \"Token required\",\r\n    message: \"A token is required to fulfill the request.\"\r\n}, {\r\n    statusCode: 500,\r\n    title: \"Internal Server Error\",\r\n    message: \"The server encountered an internal error and was unable to complete your request.\"\r\n}, {\r\n    statusCode: 501,\r\n    title: \"Not Implemented\",\r\n    message: \"The server either does not recognize the request method, or it lacks the ability to fulfil the request.\"\r\n}, {\r\n    statusCode: 502,\r\n    title: \"Bad Gateway\",\r\n    message: \"The server was acting as a gateway or proxy and received an invalid response from the upstream server.\"\r\n}, {\r\n    statusCode: 503,\r\n    title: \"Service Unavailable\",\r\n    message: \"The server is currently unavailable (because it is overloaded or down for maintenance).\"\r\n}];\r\n\r\nmodule.exports.Errors = Errors;","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\nimport {Errors as errors} from './http-error-codes';\r\n\r\n\r\n/**\r\n * @classdesc Thrown when an application tries to call an abstract method.\r\n * @class\r\n */\r\nexport class AbstractMethodError extends Error {\r\n    /**\r\n     * @param {string=} msg\r\n     */\r\n    constructor(msg) {\r\n        super(msg);\r\n        this.message = msg || 'Class does not implement inherited abstract method.';\r\n        if (typeof Error.captureStackTrace === 'function') {\r\n            Error.captureStackTrace(this, this.constructor);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Thrown when an application tries to instantiate an abstract class.\r\n * @class\r\n */\r\nexport class AbstractClassError extends Error {\r\n    /**\r\n     * @param {string=} msg\r\n     */\r\n    constructor(msg) {\r\n        this.message = msg || 'An abstract class cannot be instantiated.';\r\n        if (typeof Error.captureStackTrace === 'function') {\r\n            Error.captureStackTrace(this, this.constructor);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Represents an error with a code.\r\n * @class\r\n */\r\nexport class CodedError extends Error {\r\n    /**\r\n     * @param {string} msg\r\n     * @param {string} code\r\n     */\r\n    constructor(msg, code) {\r\n        this.message = msg;\r\n        this.code = code;\r\n        if (typeof Error.captureStackTrace === 'function') {\r\n            Error.captureStackTrace(this, this.constructor);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Thrown when an application tries to access a file which does not exist.\r\n * @class\r\n */\r\nexport class FileNotFoundError extends CodedError {\r\n    /**\r\n    * @param {string=} msg\r\n    */\r\n    constructor(msg) {\r\n        super(msg | 'File not found', \"EFOUND\");\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @classdesc Represents an HTTP error.\r\n * @class\r\n * @param {number} status\r\n * @param {string=} message\r\n * @param {string=} innerMessage\r\n * @constructor\r\n * @extends CodedError\r\n */\r\nexport class HttpError extends CodedError {\r\n    constructor(status, message, innerMessage) {\r\n        super(message, \"EHTTP\");\r\n        const finalStatus = Number.isNumber(status) ? status : 500;\r\n        const err = errors.find( x => {\r\n            return x.statusCode === finalStatus;\r\n        });\r\n        if (err) {\r\n            this.title = err.title;\r\n            this.message = message || err.message;\r\n            this.statusCode = err.statusCode;\r\n        }\r\n        else {\r\n            this.title = 'Internal Server Error';\r\n            this.message = message || 'The server encountered an internal error and was unable to complete the request.';\r\n            this.statusCode = finalStatus\r\n        }\r\n        if (typeof innerMessage !== 'undefined') {\r\n            this.innerMessage = innerMessage;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Error=} err\r\n     * @returns {HttpError}\r\n     */\r\n    static create(err) {\r\n        if (err == null) {\r\n            return new HttpError(500);\r\n        }\r\n        if (err.hasOwnProperty('statusCode')) {\r\n            return Object.assign(new HttpError(err.statusCode, err.message), err);\r\n        }\r\n        else {\r\n            return Object.assign(new HttpError(500, err.message), err);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Represents a 400 HTTP Bad Request error.\r\n * @class\r\n */\r\nexport class HttpBadRequestError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(400, message, innerMessage);\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Represents a 404 HTTP Not Found error.\r\n * @class\r\n * @property {string} resource - Gets or sets the requested resource which could not to be found\r\n */\r\n export class HttpNotFoundError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(404, message, innerMessage);\r\n    }\r\n }\r\n/**\r\n * @classdesc Represents a 405 HTTP Method Not Allowed error.\r\n * @class\r\n */\r\nexport class HttpMethodNotAllowedError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(405, message, innerMessage);\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Represents a 401 HTTP Unauthorized error.\r\n * @class\r\n */\r\nexport class HttpUnauthorizedError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(401, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc HTTP 406 Not Acceptable exception class\r\n * @class\r\n */\r\nexport class HttpNotAcceptableError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(406, message, innerMessage);\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc HTTP 408 RequestTimeout exception class\r\n * @class\r\n */\r\nexport class HttpRequestTimeoutError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(408, message, innerMessage);\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc HTTP 409 Conflict exception class\r\n * @class\r\n */\r\nexport class HttpConflictError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(409, message, innerMessage);\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc HTTP 498 Token Expired exception class\r\n * @class\r\n */\r\nexport class HttpTokenExpiredError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(498, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc HTTP 499 Token Required exception class\r\n * @class\r\n */\r\nexport class HttpTokenRequiredError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(499, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc Represents a 403 HTTP Forbidden error.\r\n * @class\r\n */\r\nexport class HttpForbiddenError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(403, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc Represents a 500 HTTP Internal Server error.\r\n * @class\r\n */\r\nexport class HttpServerError extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(500, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc Represents a 503 HTTP Service Unavailable.\r\n * @class\r\n */\r\nexport class HttpServiceUnavailable extends HttpError {\r\n    constructor(message, innerMessage) {\r\n        super(503, message, innerMessage);\r\n    }\r\n}\r\n/**\r\n * @classdesc Extends Error object for throwing exceptions on data operations\r\n * @class\r\n * @property {string} code - A string that represents an error code e.g. EDATA\r\n * @property {string} message -  The error message.\r\n * @property {string} innerMessage - The error inner message.\r\n * @property {number} status - A number that represents an error status. This error status may be used for throwing the appropriate HTTP error.\r\n * @property {*} additionalData - Additional data associated with this error\r\n */\r\nexport class DataError extends CodedError {\r\n    /**\r\n     * @param {string=} code - A string that represents an error code\r\n     * @param {string=} message - The error message\r\n     * @param {string=} innerMessage - The error inner message\r\n     * @param {string=} model - The target model\r\n     * @param {string=} field - The target field\r\n     * @param {*} additionalData - Additional data associated with this error\r\n     */\r\n    constructor(code, message, innerMessage, model, field, additionalData) {\r\n        super(message, code);\r\n        this.code = code || 'EDATA';\r\n        if (typeof model !== 'undefined') {\r\n            this.model = model;\r\n        }\r\n        if (typeof field !== 'undefined') {\r\n            this.field = field;\r\n        }\r\n        this.message = message || 'A general data error occured.';\r\n        if (typeof innerMessage !== 'undefined') {\r\n            this.innerMessage = innerMessage;\r\n        }\r\n        this.additionalData = additionalData;\r\n    }\r\n}\r\n\r\n/**\r\n * Thrown when an application attempts to access a data object that cannot be found.\r\n */\r\nexport class NotNullError extends DataError {\r\n    /**\r\n    * @param {string=} message - The error message\r\n    * @param {string=} innerMessage - The error inner message\r\n    * @param {string=} model - The target model\r\n    * @param {string=} field - The target field\r\n    */\r\n    constructor(message, innerMessage, model, field) {\r\n        super('ENULL', message || 'A value is required.', innerMessage, model, field);\r\n        this.statusCode = 409;\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc Thrown when an application attempts to access a data object that cannot be found.\r\n * @class\r\n */\r\nexport class DataNotFoundError extends DataError {\r\n    /**\r\n    * @param {string=} message - The error message\r\n    * @param {string=} innerMessage - The error inner message\r\n    * @param {string=} model - The target model\r\n    */\r\n    constructor(message, innerMessage, model) {\r\n        super('EFOUND', message || 'The requested data was not found.', innerMessage, model);\r\n        this.statusCode = 404;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @classdesc Thrown when a data object operation is denied\r\n */\r\nexport class AccessDeniedError extends DataError {\r\n    /**\r\n    * @param {string=} message - The error message\r\n    * @param {string=} innerMessage - The error inner message\r\n    * @param {string=} model - The target model\r\n    */\r\n    constructor(message, innerMessage, model) {\r\n        super('EACCESS', ('Access Denied' || message), innerMessage, model);\r\n        this.statusCode = 401;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @classdesc Thrown when a unique constraint is being violated\r\n */\r\nexport class UniqueConstraintError extends DataError {\r\n    /**\r\n    * @param {string=} message - The error message\r\n    * @param {string=} innerMessage - The error inner message\r\n    * @param {string=} model - The target model\r\n    */\r\n    constructor(message, innerMessage, model) {\r\n        super('EUNQ', message || 'A unique constraint violated', innerMessage, model);\r\n        this.statusCode = 409;\r\n    }\r\n}\r\n","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\nimport {sprintf} from \"sprintf\";\r\n\r\nconst IS_NODE = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\r\nconst UUID_CHARS = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\r\nconst HEX_CHARS = 'abcdef1234567890';\r\nconst STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\r\nconst DATE_TIME_REGEX = /^\\d{4}-([0]\\d|1[0-2])-([0-2]\\d|3[01])(?:[T ](\\d+):(\\d+)(?::(\\d+)(?:\\.(\\d+))?)?)?(?:Z(-?\\d*))?$/g;\r\nconst BOOLEAN_TRUE_REGEX = /^true$/ig;\r\nconst BOOLEAN_FALSE_REGEX = /^false$/ig;\r\nconst NULL_REGEX = /^null$/ig;\r\nconst UNDEFINED_REGEX = /^undefined$/ig;\r\nconst INT_REGEX =/^[-+]?\\d+$/g;\r\nconst FLOAT_REGEX =/^[+-]?\\d+(\\.\\d+)?$/g;\r\nconst GUID_REGEX = /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;\r\n\r\nconst LOG_LEVELS = {\r\n    error: 0,\r\n    warn: 1,\r\n    info: 2,\r\n    verbose: 3,\r\n    debug: 4\r\n};\r\n\r\nexport class UnknownPropertyDescriptor {\r\n    constructor(obj, name) {\r\n        Object.defineProperty(this, 'value', { \r\n            configurable:false, \r\n            enumerable:true, \r\n            get: function() { \r\n                    return obj[name]; \r\n                }, \r\n            set: function(value) { \r\n                    obj[name]=value; \r\n                }\r\n        });\r\n        Object.defineProperty(this, 'name', { \r\n            configurable:false, \r\n            enumerable:true, \r\n            get: function() { \r\n                return name; \r\n                } \r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class LangUtils {\r\n    /**\r\n     * Inherit the prototype methods from one constructor into another.\r\n     * @param {Function} ctor\r\n     * @param {Function|*} superCtor\r\n     * @deprecated This method has been deprecated and it will be removed in next version\r\n     * @example\r\n    function Animal() {\r\n        //\r\n    }\r\n\r\n    function Dog() {\r\n        Dog.super_.bind(this)();\r\n    }\r\n    LangUtils.inherits(Dog,Animal);\r\n     */\r\n    static inherits(ctor, superCtor) {\r\n\r\n        if (typeof superCtor !== \"function\" && superCtor !== null) {\r\n            throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superCtor);\r\n        }\r\n\r\n        //if process is running under node js\r\n        if (IS_NODE) {\r\n            const utilModule = \"util\";\r\n            const util = require(utilModule);\r\n            //call util.inherits() function\r\n            return util.inherits(ctor, superCtor);\r\n        }\r\n\r\n        ctor.prototype = Object.create(superCtor && superCtor.prototype, {\r\n            constructor: {\r\n                value: ctor,\r\n                enumerable: false,\r\n                writable: true,\r\n                configurable: true\r\n            }\r\n        });\r\n        if (superCtor) {\r\n            /**\r\n             * @function setPrototypeOf\r\n             * @param {*} obj\r\n             * @param {*} prototype\r\n             * @memberOf Object\r\n             * @static\r\n             */\r\n            if (typeof Object.setPrototypeOf === 'function') {\r\n                Object.setPrototypeOf(ctor, superCtor)\r\n            }\r\n            else {\r\n                ctor.__proto__ = superCtor\r\n            }\r\n        }\r\n        //node.js As an additional convenience, superConstructor will be accessible through the constructor.super_ property.\r\n        ctor.super_ = ctor.__proto__;\r\n    }\r\n\r\n    /**\r\n     * Returns an array of strings which represents the arguments' names of the given function\r\n     * @param {Function} fn\r\n     * @returns {Array}\r\n     */\r\n    static getFunctionParams(fn) {\r\n        if (typeof fn === 'function')\r\n            return [];\r\n        const fnStr = fn.toString().replace(STRIP_COMMENTS, '');\r\n        let result = fnStr.slice(fnStr.indexOf('(')+1, fnStr.indexOf(')')).match(/([^\\s,]+)/g);\r\n        if(result === null)\r\n            result = [];\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {string} value\r\n     */\r\n    static convert(value) {\r\n        let result;\r\n        if ((typeof value === 'string'))\r\n        {\r\n            if (value.length===0) {\r\n                result = value\r\n            }\r\n            if (value.match(BOOLEAN_TRUE_REGEX)) {\r\n                result = true;\r\n            }\r\n            else if (value.match(BOOLEAN_FALSE_REGEX)) {\r\n                result = false;\r\n            }\r\n            else if (value.match(NULL_REGEX) || value.match(UNDEFINED_REGEX)) {\r\n                result = null;\r\n            }\r\n            else if (value.match(INT_REGEX)) {\r\n                result = parseInt(value);\r\n            }\r\n            else if (value.match(FLOAT_REGEX)) {\r\n                result = parseFloat(value);\r\n            }\r\n            else if (value.match(DATE_TIME_REGEX)) {\r\n                result = new Date(Date.parse(value));\r\n            }\r\n            else {\r\n                result = value;\r\n            }\r\n        }\r\n        else {\r\n            result = value;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {*} origin\r\n     * @param {string} expr\r\n     * @param {string} value\r\n     * @param {*=} options\r\n     * @returns {*}\r\n     */\r\n    static extend(origin, expr, value, options) {\r\n\r\n        options = options || { convertValues:false };\r\n        //find base notation\r\n        let match = /(^\\w+)\\[/.exec(expr), name, descriptor, expr1;\r\n        if (match) {\r\n            //get property name\r\n            name = match[1];\r\n            //validate array property\r\n            if (/^\\d+$/g.test(name)) {\r\n                //property is an array\r\n                if (!Array.isArray(origin.value))\r\n                    origin.value = [];\r\n                // get new expression\r\n                expr1 = expr.substr(match.index + match[1].length);\r\n                LangUtils.extend(origin, expr1, value, options);\r\n            }\r\n            else {\r\n                //set property value (unknown)\r\n                origin[name] = origin[name] || new LangUtils();\r\n                descriptor = new UnknownPropertyDescriptor(origin, name);\r\n                // get new expression\r\n                expr1 = expr.substr(match.index + match[1].length);\r\n                LangUtils.extend(descriptor, expr1, value, options);\r\n            }\r\n        }\r\n        else if (expr.indexOf('[')===0) {\r\n            //get property\r\n            const re = /\\[(.*?)\\]/g;\r\n            match = re.exec(expr);\r\n            if (match) {\r\n                name = match[1];\r\n                // get new expression\r\n                expr1 = expr.substr(match.index + match[0].length);\r\n                if (/^\\d+$/g.test(name)) {\r\n                    //property is an array\r\n                    if (!Array.isArray(origin.value))\r\n                        origin.value = [];\r\n                }\r\n                if (expr1.length===0) {\r\n                    if (origin.value instanceof LangUtils) {\r\n                        origin.value = {};\r\n                    }\r\n                    let typedValue;\r\n                    //convert string value\r\n                    if ((typeof value === 'string') && options.convertValues) {\r\n                        typedValue = LangUtils.convert(value);\r\n                    }\r\n                    else {\r\n                        typedValue = value;\r\n                    }\r\n                    if (Array.isArray(origin.value))\r\n                        origin.value.push(typedValue);\r\n                    else\r\n                        origin.value[name] = typedValue;\r\n                }\r\n                else {\r\n                    if (origin.value instanceof LangUtils) {\r\n                        origin.value = { };\r\n                    }\r\n                    origin.value[name] = origin.value[name] || new LangUtils();\r\n                    descriptor = new UnknownPropertyDescriptor(origin.value, name);\r\n                    LangUtils.extend(descriptor, expr1, value, options);\r\n                }\r\n            }\r\n            else {\r\n                throw new Error('Invalid object property notation. Expected [name]');\r\n            }\r\n        }\r\n        else if (/^\\w+$/.test(expr)) {\r\n            if (options.convertValues)\r\n                origin[expr] = LangUtils.convert(value);\r\n            else\r\n                origin[expr] = value;\r\n        }\r\n        else {\r\n            throw new Error('Invalid object property notation. Expected property[name] or [name]');\r\n        }\r\n        return origin;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {*} form\r\n     * @param {*=} options\r\n     * @returns {*}\r\n     */\r\n    static parseForm(form, options) {\r\n        const result = {};\r\n        if (typeof form === 'undefined' || form===null)\r\n            return result;\r\n        const keys = Object.keys(form);\r\n        keys.forEach(key => {\r\n            if (form.hasOwnProperty(key))\r\n            {\r\n                LangUtils.extend(result, key, form[key], options)\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Parses any value or string and returns the resulted object.\r\n     * @param {*} any\r\n     * @returns {*}\r\n     */\r\n    static parseValue(any) {\r\n        return LangUtils.convert(any);\r\n    }\r\n\r\n    /**\r\n     * Parses any value and returns the equivalent integer.\r\n     * @param {*} any\r\n     * @returns {*}\r\n     */\r\n    static parseInt(any) {\r\n        return parseInt(any) || 0;\r\n    }\r\n\r\n    /**\r\n     * Parses any value and returns the equivalent float number.\r\n     * @param {*} any\r\n     * @returns {*}\r\n     */\r\n    static parseFloat(any) {\r\n        return parseFloat(any) || 0;\r\n    }\r\n\r\n    /**\r\n     * Parses any value and returns the equivalent boolean.\r\n     * @param {*} any\r\n     * @returns {*}\r\n     */\r\n    static parseBoolean(any) {\r\n        if (typeof any === 'undefined' || any === null)\r\n            return false;\r\n        else if (typeof any === 'number')\r\n            return any !== 0;\r\n        else if (typeof any === 'string') {\r\n            if (any.match(INT_REGEX) || any.match(FLOAT_REGEX)) {\r\n                return parseInt(any, 10) !== 0;\r\n            }\r\n            else if (any.match(BOOLEAN_TRUE_REGEX))\r\n                return true;\r\n            else if (any.match(BOOLEAN_FALSE_REGEX))\r\n                return false;\r\n            else if (/^yes$|^on$|^y$|^valid$/i.test(any))\r\n                return true;\r\n            else if (/^no$|^off$|^n$|^invalid$/i.test(any))\r\n                return false;\r\n            else\r\n                return false;\r\n        }\r\n        else if (typeof any === 'boolean')\r\n            return any;\r\n        else {\r\n            return (parseInt(any) || 0) !== 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @static\r\n     * Checks if the given value is a valid date\r\n     * @param {*} value\r\n     * @returns {boolean}\r\n     */\r\n    static isDate(value) {\r\n        if (value instanceof Date) {\r\n            return true;\r\n        }\r\n        return DATE_TIME_REGEX.test(value);\r\n    }\r\n}\r\n\r\n/**\r\n * @function captureStackTrace\r\n * @memberOf Error\r\n * @param {Error} thisArg\r\n * @param {string} name\r\n * @static\r\n */\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class Args {\r\n    /**\r\n     * Checks the expression and throws an exception if the condition is not met.\r\n     * @param {*} expr\r\n     * @param {string|Error} err\r\n     */\r\n    static check(expr, err) {\r\n        Args.notNull(expr,\"Expression\");\r\n        let res;\r\n        if (typeof expr === 'function') {\r\n            res = !(expr.call());\r\n        }\r\n        else {\r\n            res = (!expr);\r\n        }\r\n        if (res) {\r\n            if (err instanceof Error) {\r\n                throw err;\r\n            }\r\n            throw new ArgumentError(err, \"ECHECK\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {*} arg\r\n     * @param {string} name\r\n     */\r\n    static notNull(arg, name) {\r\n        if (typeof arg === 'undefined' || arg === null) {\r\n            throw new ArgumentError(name + \" may not be null or undefined\", \"ENULL\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {*} arg\r\n     * @param {string} name\r\n     */\r\n    static notString(arg, name) {\r\n        if (typeof arg !== 'string') {\r\n            throw new ArgumentError(name + \" must be a string\", \"EARG\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {*} arg\r\n     * @param {string} name\r\n     */\r\n    static notFunction(arg, name) {\r\n        if (typeof arg !== 'function') {\r\n            throw new ArgumentError(name + \" must be a function\", \"EARG\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {*} arg\r\n     * @param {string} name\r\n     */\r\n    static notNumber(arg, name) {\r\n        if ((typeof arg !== 'number') || isNaN(arg)) {\r\n            throw new ArgumentError(name + \" must be number\", \"EARG\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string|*} arg\r\n     * @param {string} name\r\n     */\r\n    static notEmpty(arg, name) {\r\n        Args.notNull(arg,name);\r\n        if ((Object.prototype.toString.bind(arg)() === '[object Array]') && (arg.length === 0)) {\r\n            throw new ArgumentError(name + \" may not be empty\",\"EEMPTY\");\r\n        }\r\n        else if ((typeof arg === 'string') && (arg.length===0)) {\r\n            throw new ArgumentError(name + \" may not be empty\",\"EEMPTY\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|*} arg\r\n     * @param {string} name\r\n     */\r\n    static notNegative(arg, name) {\r\n        Args.notNumber(arg,name);\r\n        if (arg<0) {\r\n            throw new ArgumentError(name + \" may not be negative\", \"ENEG\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {number|*} arg\r\n     * @param {string} name\r\n     */\r\n    static notPositive(arg, name) {\r\n        Args.notNumber(arg,name);\r\n        if (arg<=0) {\r\n            throw new ArgumentError(name + \" may not be negative or zero\", \"EPOS\");\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class TextUtils {\r\n    /**\r\n     * Converts the given parameter to MD5 hex string\r\n     * @static\r\n     * @param {*} value\r\n     * @returns {string|undefined}\r\n     */\r\n    static toMD5(value) {\r\n\r\n        if (typeof value === 'undefined' || value === null) {\r\n            return;\r\n        }\r\n        //browser implementation\r\n        let md5, md5module;\r\n        if (typeof window !== 'undefined') {\r\n            md5module = 'blueimp-md5';\r\n            md5 = require(md5module);\r\n            if (typeof value === 'string') {\r\n                return md5(value);\r\n            }\r\n            else if (value instanceof Date) {\r\n                return md5(value.toUTCString());\r\n            }\r\n            else {\r\n                return md5(JSON.stringify(value));\r\n            }\r\n        }\r\n        //node.js implementation\r\n        md5module = 'crypto';\r\n        const crypto = require(md5module);\r\n        md5 = crypto.createHash('md5');\r\n        if (typeof value === 'string') {\r\n            md5.update(value);\r\n        }\r\n        else if (value instanceof Date) {\r\n            md5.update(value.toUTCString());\r\n        }\r\n        else {\r\n            md5.update(JSON.stringify(value));\r\n        }\r\n        return md5.digest('hex');\r\n    }\r\n\r\n    /**\r\n     * Converts the given parameter to SHA1 hex string\r\n     * @static\r\n     * @param {*} value\r\n     * @returns {string|undefined}\r\n     */\r\n    static toSHA1(value) {\r\n\r\n        const cryptoModule = 'crypto';\r\n        if (typeof window !== 'undefined') {\r\n            throw new Error('This method is not implemented for this environment')\r\n        }\r\n\r\n        const crypto = require(cryptoModule);\r\n        if (typeof value === 'undefined' || value === null) {\r\n            return;\r\n        }\r\n        const sha1 = crypto.createHash('sha1');\r\n        if (typeof value === 'string') {\r\n            sha1.update(value);\r\n        }\r\n        else if (value instanceof Date) {\r\n            sha1.update(value.toUTCString());\r\n        }\r\n        else {\r\n            sha1.update(JSON.stringify(value));\r\n        }\r\n        return sha1.digest('hex');\r\n    }\r\n\r\n    /**\r\n     * Converts the given parameter to SHA256 hex string\r\n     * @static\r\n     * @param {*} value\r\n     * @returns {string|undefined}\r\n     */\r\n    static toSHA256(value) {\r\n\r\n        const cryptoModule = 'crypto';\r\n        if (typeof window !== 'undefined') {\r\n            throw new Error('This method is not implemented for this environment')\r\n        }\r\n\r\n        const crypto = require(cryptoModule);\r\n        if (typeof value === 'undefined' || value === null) {\r\n            return;\r\n        }\r\n        const sha256 = crypto.createHash('sha256');\r\n        if (typeof value === 'string') {\r\n            sha256.update(value);\r\n        }\r\n        else if (value instanceof Date) {\r\n            sha256.update(value.toUTCString());\r\n        }\r\n        else {\r\n            sha256.update(JSON.stringify(value));\r\n        }\r\n        return sha256.digest('hex');\r\n    }\r\n\r\n    /**\r\n     * Returns a random GUID/UUID string\r\n     * @static\r\n     * @returns {string}\r\n     */\r\n    static newUUID() {\r\n        const chars = UUID_CHARS;\r\n        const uuid = [];\r\n        // rfc4122, version 4 form\r\n        let r = void 0;\r\n        // rfc4122 requires these characters\r\n        uuid[8] = uuid[13] = uuid[18] = uuid[23] = \"-\";\r\n        uuid[14] = \"4\";\r\n\r\n        // Fill in random data.  At i==19 set the high bits of clock sequence as\r\n        // per rfc4122, sec. 4.1.5\r\n        for (let i = 0; i < 36; i++) {\r\n            if (!uuid[i]) {\r\n                r = 0 | Math.random() * 16;\r\n                uuid[i] = chars[i === 19 ? r & 0x3 | 0x8 : r];\r\n            }\r\n        }\r\n        return uuid.join(\"\");\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @param {*} options\r\n * @constructor\r\n */\r\nexport class TraceLogger {\r\n    constructor(options) {\r\n        this.options = {\r\n            colors:false,\r\n            level:\"info\"\r\n        };\r\n        if (typeof options === \"undefined\" && options !== null && IS_NODE) {\r\n            if (IS_NODE && process.env.NODE_ENV === \"development\") {\r\n                this.options.level = \"debug\";\r\n            }\r\n        }\r\n        if (typeof options !== \"undefined\" && options !== null ) {\r\n            this.options = options;\r\n            //validate logging level\r\n            Args.check(LOG_LEVELS.hasOwnProperty(this.options.level), \"Invalid logging level. Expected error, warn, info, verbose or debug.\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} level\r\n     * @returns {*}\r\n     */\r\n    level(level) {\r\n        Args.check(LOG_LEVELS.hasOwnProperty(level), \"Invalid logging level. Expected error, warn, info, verbose or debug.\");\r\n        this.options.level = level;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    log(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"info\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"info\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"info\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"info\", data);\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    info(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"info\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"info\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"info\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"info\", data);\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    error(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"error\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"error\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"error\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"error\", data);\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    warn(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"warn\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"warn\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"warn\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"warn\", data);\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    verbose(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"verbose\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"verbose\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"verbose\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"verbose\", data);\r\n    }\r\n\r\n    /**\r\n     * @param {...*} data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    debug(data) {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        if (typeof data === 'undefined' || data === null) {\r\n            return;\r\n        }\r\n        if (data instanceof Error) {\r\n            return writeError.bind(this)(\"debug\",data);\r\n        }\r\n        if (typeof data !== 'string') {\r\n            return this.write(\"debug\", data.toString());\r\n        }\r\n        if (args.length>1) {\r\n            return this.write(\"debug\", sprintf.apply(null, args));\r\n        }\r\n        this.write(\"debug\", data);\r\n\r\n    }\r\n\r\n    write(level, text) {\r\n        if (LOG_LEVELS[level]>LOG_LEVELS[this.options.level]) {\r\n            return;\r\n        }\r\n        // eslint-disable-next-line no-console\r\n        console.log(timestamp() + \" [\" + level.toUpperCase() + \"] \" + text);\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class TraceUtils {\r\n    static useLogger(logger) {\r\n        TraceUtils._logger = logger;\r\n    }\r\n\r\n    static level(level) {\r\n        TraceUtils._logger.level(level);\r\n    }\r\n\r\n    /**\r\n     * @static\r\n     * @param {...*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static log(_data) {\r\n        TraceUtils._logger.log.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n\r\n    /**\r\n     * @static\r\n     * @param {...*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static error(_data) {\r\n        TraceUtils._logger.error.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @static\r\n     * @param {...*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static info(_data) {\r\n        TraceUtils._logger.info.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @static\r\n     * @param {*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static warn(_data) {\r\n        TraceUtils._logger.warn.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @static\r\n     * @param {*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static verbose(_data) {\r\n        TraceUtils._logger.verbose.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @static\r\n     * @param {...*} _data\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static debug(_data) {\r\n        TraceUtils._logger.debug.apply(TraceUtils._logger, Array.prototype.slice.call(arguments));\r\n    }\r\n}\r\nObject.defineProperty(TraceUtils, '_logger', {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value: new TraceLogger()\r\n});\r\n\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class RandomUtils {\r\n    /**\r\n     * Returns a random string based on the length specified\r\n     * @param {Number} length\r\n     */\r\n    static randomChars(length) {\r\n        length = length || 8;\r\n        const chars = \"abcdefghkmnopqursuvwxz2456789ABCDEFHJKLMNPQURSTUVWXYZ\";\r\n        let str = \"\";\r\n        for(let i = 0; i < length; i++) {\r\n            str += chars.substr(this.randomInt(0, chars.length-1),1);\r\n        }\r\n        return str;\r\n    }\r\n\r\n    /**\r\n     * Returns a random integer between a minimum and a maximum value\r\n     * @param {number} min\r\n     * @param {number} max\r\n     */\r\n    static randomInt(min, max) {\r\n        return Math.floor(Math.random() * (max - min + 1)) + min;\r\n    }\r\n\r\n    /**\r\n     * Returns a random string based on the length specified\r\n     * @static\r\n     * @param {number} length\r\n     * @returns {string}\r\n     */\r\n    static randomHex(length) {\r\n        length = (length || 8)*2;\r\n        let str = \"\";\r\n        for(let i = 0; i < length; i++) {\r\n            str += HEX_CHARS.substr(this.randomInt(0, HEX_CHARS.length-1),1);\r\n        }\r\n        return str;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class NumberUtils {\r\n    /**\r\n     * Converts a base-26 formatted string to the equivalent integer\r\n     * @static\r\n     * @param {string} s A base-26 formatted string e.g. aaaaaaaa for 0, baaaaaaa for 1 etc\r\n     * @return {number} The equivalent integer value\r\n     */\r\n    static fromBase26(s) {\r\n        let num = 0;\r\n        if (!/[a-z]{8}/.test(s)) {\r\n            throw new Error('Invalid base-26 format.');\r\n        }\r\n        const a = 'a'.charCodeAt(0);\r\n        for (let i = 7; i >=0; i--) {\r\n            num = (num * 26) + (s[i].charCodeAt(0) - a);\r\n        }\r\n        return num;\r\n    }\r\n\r\n    /**\r\n     * Converts an integer to the equivalent base-26 formatted string\r\n     * @static\r\n     * @param {number} x The integer to be converted\r\n     * @return {string} The equivalent string value\r\n     */\r\n    static toBase26(x) {\r\n        //noinspection ES6ConvertVarToLetConst\r\n        var num = parseInt(x);\r\n        if (num<0) {\r\n            throw new Error('A non-positive integer cannot be converted to base-26 format.');\r\n        }\r\n        if (num>208827064575) {\r\n            throw new Error('A positive integer bigger than 208827064575 cannot be converted to base-26 format.');\r\n        }\r\n        let out = \"\";\r\n        let length = 1;\r\n        const a = 'a'.charCodeAt(0);\r\n        while(length<=8)\r\n        {\r\n            out += String.fromCharCode(a + (num % 26));\r\n            num = Math.floor(num / 26);\r\n            length += 1;\r\n        }\r\n        return out;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n */\r\nexport class PathUtils {\r\n    /**\r\n     *\r\n     * @param {...string} _part\r\n     * @returns {string}\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    static join(_part) {\r\n        const pathModule = \"path\";\r\n        if (IS_NODE) {\r\n            const path = require(pathModule);\r\n            return path.join.apply(null, Array.prototype.slice.call(arguments));\r\n        }\r\n        // Split the inputs into a list of path commands.\r\n        let parts = [], i, l;\r\n        for (i = 0, l = arguments.length; i < l; i++) {\r\n            parts = parts.concat(arguments[i].split(\"/\"));\r\n        }\r\n    // Interpret the path commands to get the new resolved path.\r\n        const newParts = [];\r\n        for (i = 0, l = parts.length; i < l; i++) {\r\n            const part1 = parts[i];\r\n            // Remove leading and trailing slashes\r\n            // Also remove \".\" segments\r\n            if (!part1 || part1 === \".\") continue;\r\n            // Interpret \"..\" to pop the last segment\r\n            if (part1 === \"..\") newParts.pop();\r\n            // Push new path segments.\r\n            else newParts.push(part1);\r\n        }\r\n    // Preserve the initial slash if there was one.\r\n        if (parts[0] === \"\") newParts.unshift(\"\");\r\n    // Turn back into a single string path.\r\n        return newParts.join(\"/\") || (newParts.length ? \"/\" : \".\");\r\n    }\r\n}\r\n\r\n/**\r\n * @private\r\n * @returns {string}\r\n */\r\nfunction timestamp() {\r\n    return (new Date()).toUTCString();\r\n}\r\n\r\n/**\r\n * @private\r\n * @this TraceLogger\r\n * @param level\r\n * @param err\r\n */\r\nfunction writeError(level, err) {\r\n\r\n    const keys = Object.keys(err).filter(x => {\r\n        return err.hasOwnProperty(x) && x !== 'message' && typeof err[x] !== 'undefined' && err[x] != null;\r\n    });\r\n    if (err instanceof Error) {\r\n        if (err.hasOwnProperty('stack')) {\r\n            this.write(level, err.stack);\r\n        }\r\n        else {\r\n            this.write(level, err.toString());\r\n        }\r\n    }\r\n    else {\r\n        this.write(level, err.toString());\r\n    }\r\n    if (keys.length>0) {\r\n        this.write(level, \"Error: \" + keys.map( x => {\r\n            return \"[\" + x + \"]=\" + err[x].toString()\r\n        }).join(', '));\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @param {number} value\r\n * @constructor\r\n */\r\nexport class Base26Number {\r\n\r\n    constructor(value) {\r\n        const thisValue = value;\r\n        this.toString = () => {\r\n            return Base26Number.toBase26(thisValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {number} x\r\n     * @returns {string}\r\n     */\r\n    static toBase26(x) {\r\n        let num = Math.floor(x | 0);\r\n        if (num<0) {\r\n            throw new Error(\"A non-positive integer cannot be converted to base-26 format.\");\r\n        }\r\n        if (num>208827064575) {\r\n            throw new Error(\"A positive integer bigger than 208827064575 cannot be converted to base-26 format.\");\r\n        }\r\n        let out = \"\";\r\n        let length = 1;\r\n        const a = \"a\".charCodeAt(0);\r\n        while(length<=8) {\r\n            out += String.fromCharCode(a + (num % 26));\r\n            num = Math.floor(num / 26);\r\n            length += 1;\r\n        }\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {string} s\r\n     * @returns {number}\r\n     */\r\n    static fromBase26(s) {\r\n        let num = 0;\r\n        if (!/[a-z]{8}/.test(s)) {\r\n            throw new Error(\"Invalid base-26 format.\");\r\n        }\r\n        const a = \"a\".charCodeAt(0);\r\n        for (let i = 7; i >=0; i--) {\r\n            num = (num * 26) + (s[i].charCodeAt(0) - a);\r\n        }\r\n        return num;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @param {string=} value\r\n * @constructor\r\n */\r\nexport class Guid {\r\n    constructor(value) {\r\n        let _value;\r\n        if (typeof value === \"string\") {\r\n            // format value\r\n            _value = value.replace(/^{/,\"\").replace(/{$/,\"\");\r\n            // and validate\r\n            Args.check(GUID_REGEX.test(_value),\"Value must be a valid UUID\");\r\n        }\r\n        else {\r\n            // generate a new guid string\r\n            _value = TextUtils.newUUID();\r\n        }\r\n        // define property\r\n        Object.defineProperty(this, '_value', {\r\n                enumerable: false,\r\n                configurable: true,\r\n                value: _value\r\n            });\r\n    }\r\n\r\n    toJSON() {\r\n        return this._value;\r\n    }\r\n\r\n    valueOf() {\r\n        return this._value;\r\n    }\r\n\r\n    toString() {\r\n        return this._value;\r\n    }\r\n\r\n    equals(b) {\r\n        if (b instanceof Guid) {\r\n            return this._value.toLowerCase() === b._value.toLowerCase();\r\n        }\r\n        if (typeof b === 'string') {\r\n            return this._value.toLowerCase() === b.toLowerCase();\r\n        }\r\n        return this._value === b;\r\n    }\r\n\r\n    /**\r\n     * @param {string|*} s\r\n     * @returns {boolean}\r\n     */\r\n    static isGuid(s) {\r\n        if (s instanceof Guid) {\r\n            return true;\r\n        }\r\n        if (typeof s !== \"string\") {\r\n            return false;\r\n        }\r\n        return GUID_REGEX.test(s);\r\n    }\r\n\r\n    /**\r\n     * @returns {Guid}\r\n     */\r\n    static newGuid() {\r\n        return new Guid();\r\n    }\r\n}\r\n\r\nexport class ArgumentError extends TypeError {\r\n    /**\r\n    * @param {string} msg\r\n    * @param {string} code\r\n    */\r\n    constructor(msg, code) {\r\n        super(msg);\r\n        this.code = code || \"ERR_ARG\";\r\n        if (typeof Error.captureStackTrace === 'function') {\r\n            Error.captureStackTrace(this, this.constructor);\r\n        }\r\n    }\r\n}\r\n","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\nimport _ from 'lodash';\r\nimport {Args} from './utils';\r\nimport {TraceUtils} from './utils';\r\nimport {PathUtils} from './utils';\r\nimport {AbstractClassError} from './errors';\r\n\r\n/**\r\n * @class Represents an application configuration\r\n * @param {string=} configPath\r\n * @property {*} settings\r\n * @constructor\r\n */\r\nexport class ConfigurationBase {\r\n    constructor(configPath) {\r\n        \r\n        // set strategies\r\n        Object.defineProperty(this, '_strategies', {\r\n            enumerable: false,\r\n            writable: false,\r\n            value: { }\r\n        });\r\n\r\n        // set configuration path\r\n        Object.defineProperty(this, '_configurationPath', {\r\n            enumerable: false,\r\n            writable: false,\r\n            value: configPath || PathUtils.join(process.cwd(),'config')\r\n        });\r\n        TraceUtils.debug('Initializing configuration under %s.', this._configurationPath);\r\n\r\n        // set execution path\r\n        Object.defineProperty(this, '_executionPath', {\r\n            enumerable: false,\r\n            writable: false,\r\n            value: PathUtils.join(this._configurationPath,'..')\r\n        });\r\n        TraceUtils.debug('Setting execution path under %s.', this._executionPath);\r\n\r\n        // set config source\r\n        // set execution path\r\n        Object.defineProperty(this, '_config', {\r\n            enumerable: false,\r\n            configurable: false,\r\n            value: { }\r\n        });\r\n\r\n        //load default module loader strategy\r\n        this.useStrategy(ModuleLoaderStrategy, DefaultModuleLoaderStrategy);\r\n\r\n        //get configuration source\r\n        let configSourcePath;\r\n        try {\r\n            let env = 'production';\r\n            //node.js mode\r\n            if (process && process.env) {\r\n                env = process.env['NODE_ENV'] || 'production';\r\n            }\r\n            //browser mode\r\n            else if (window && window.env) {\r\n                env = window.env['BROWSER_ENV'] || 'production';\r\n            }\r\n            configSourcePath = PathUtils.join(this._configurationPath, 'app.' + env + '.json');\r\n            TraceUtils.debug('Validating environment configuration source on %s.', configSourcePath);\r\n            this._config = require(configSourcePath);\r\n        }\r\n        catch (err) {\r\n            if (err.code === 'MODULE_NOT_FOUND') {\r\n                TraceUtils.log('The environment specific configuration cannot be found or is inaccesible.');\r\n                try {\r\n                    configSourcePath = PathUtils.join(this._configurationPath, 'app.json');\r\n                    TraceUtils.debug('Validating application configuration source on %s.', configSourcePath);\r\n                    this._config = require(configSourcePath);\r\n                }\r\n                catch(err) {\r\n                    if (err.code === 'MODULE_NOT_FOUND') {\r\n                        TraceUtils.log('The default application configuration cannot be found or is inaccesible.');\r\n                    }\r\n                    else {\r\n                        TraceUtils.error('An error occured while trying to open default application configuration.');\r\n                        TraceUtils.error(err);\r\n                    }\r\n                    TraceUtils.debug('Initializing empty configuration');\r\n                    this._config = { };\r\n                }\r\n            }\r\n            else {\r\n                TraceUtils.error('An error occured while trying to open application configuration.');\r\n                TraceUtils.error(err);\r\n                //load default configuration\r\n                this._config = { };\r\n            }\r\n        }\r\n        //initialize settings object\r\n        this._config['settings'] = this._config['settings'] || { };\r\n\r\n        /**\r\n         * @name ConfigurationBase#settings\r\n         * @type {*}\r\n         */\r\n\r\n        Object.defineProperty(this, 'settings',{\r\n            get: function() {\r\n                return this._config['settings'];\r\n        },\r\n            enumerable:true,\r\n            configurable:false});\r\n\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the configuration source object\r\n     * @returns {*}\r\n     */\r\n    getSource() {\r\n        return this._config;\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns the source configuration object based on the given path (e.g. settings.auth.cookieName or settings/auth/cookieName)\r\n     * @param {string} p - A string which represents an object path\r\n     * @returns {Object|Array}\r\n     */\r\n    getSourceAt(p) {\r\n        return _.at(this._config,p.replace(/\\//g,'.'))[0];\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Returns a boolean which indicates whether the specified  object path exists or not (e.g. settings.auth.cookieName or settings/auth/cookieName)\r\n     * @param {string} p - A string which represents an object path\r\n     * @returns {boolean}\r\n     */\r\n    hasSourceAt(p) {\r\n        return _.isObject(_.at(this._config,p.replace(/\\//g,'.'))[0]);\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Sets the config value to the specified object path (e.g. settings.auth.cookieName or settings/auth/cookieName)\r\n     * @param {string} p - A string which represents an object path\r\n     * @param {*} value\r\n     * @returns {Object}\r\n     */\r\n    setSourceAt(p, value) {\r\n        return _.set(this._config, p.replace(/\\//g,'.'), value);\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Sets the current execution path\r\n     * @param {string} p\r\n     * @returns ConfigurationBase\r\n     */\r\n    setExecutionPath(p) {\r\n        this._executionPath = p;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets the current execution path\r\n     * @returns {string}\r\n     */\r\n    getExecutionPath() {\r\n        return this._executionPath;\r\n    }\r\n\r\n    /**\r\n     * Gets the current configuration path\r\n     * @returns {string}\r\n     */\r\n    getConfigurationPath() {\r\n        return this._configurationPath;\r\n    }\r\n\r\n    /**\r\n     * Register a configuration strategy\r\n     * @param {Function} configStrategyCtor\r\n     * @param {Function} strategyCtor\r\n     * @returns ConfigurationBase\r\n     */\r\n    useStrategy(configStrategyCtor, strategyCtor) {\r\n        Args.notFunction(configStrategyCtor,\"Configuration strategy constructor\");\r\n        Args.notFunction(strategyCtor,\"Strategy constructor\");\r\n        this._strategies[\"$\".concat(configStrategyCtor.name)] = new strategyCtor(this);\r\n        return this;\r\n    }\r\n\r\n    //noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Gets a configuration strategy\r\n     * @param {Function} configStrategyCtor\r\n     */\r\n    getStrategy(configStrategyCtor) {\r\n        Args.notFunction(configStrategyCtor,\"Configuration strategy constructor\");\r\n        return this._strategies[\"$\".concat(configStrategyCtor.name)];\r\n    }\r\n\r\n    /**\r\n     * Gets a configuration strategy\r\n     * @param {Function} configStrategyCtor\r\n     */\r\n    hasStrategy(configStrategyCtor) {\r\n        Args.notFunction(configStrategyCtor,\"Configuration strategy constructor\");\r\n        return typeof this._strategies[\"$\".concat(configStrategyCtor.name)] !== 'undefined';\r\n    }\r\n\r\n    /**\r\n     * Gets the current configuration\r\n     * @returns ConfigurationBase - An instance of DataConfiguration class which represents the current data configuration\r\n     */\r\n    static getCurrent() {\r\n        if (ConfigurationBase._currentConfiguration == null) {\r\n            ConfigurationBase._currentConfiguration = new ConfigurationBase();\r\n        }\r\n        return ConfigurationBase._currentConfiguration;\r\n    }\r\n\r\n    /**\r\n     * Sets the current configuration\r\n     * @param {ConfigurationBase} configuration\r\n     * @returns ConfigurationBase - An instance of ApplicationConfiguration class which represents the current configuration\r\n     */\r\n    static setCurrent(configuration) {\r\n        if (configuration instanceof ConfigurationBase) {\r\n            if (!configuration.hasStrategy(ModuleLoaderStrategy)) {\r\n                configuration.useStrategy(ModuleLoaderStrategy, DefaultModuleLoaderStrategy);\r\n            }\r\n            ConfigurationBase._currentConfiguration = configuration;\r\n            return ConfigurationBase._currentConfiguration;\r\n        }\r\n        throw new TypeError('Invalid argument. Expected an instance of DataConfiguration class.');\r\n    }\r\n}\r\n\r\nObject.defineProperty(ConfigurationBase, '_currentConfiguration', {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value: null\r\n});\r\n\r\n/**\r\n * @class\r\n * @param {ConfigurationBase} config\r\n * @constructor\r\n * @abstract\r\n */\r\nexport class ConfigurationStrategy {\r\n    constructor(config) {\r\n        Args.check(this.constructor.name !== ConfigurationStrategy, new AbstractClassError());\r\n        Args.notNull(config, 'Configuration');\r\n        this._config = config;\r\n    }\r\n\r\n    /**\r\n     * @returns {ConfigurationBase}\r\n     */\r\n    getConfiguration() {\r\n        return this._config;\r\n    }\r\n}\r\n\r\n/**\r\n * @class\r\n * @constructor\r\n * @param {ConfigurationBase} config\r\n * @extends ConfigurationStrategy\r\n */\r\nexport class ModuleLoaderStrategy extends ConfigurationStrategy {\r\n    constructor(config) {\r\n        super(config);\r\n    }\r\n\r\n    require(modulePath) {\r\n        Args.notEmpty(modulePath,'Module Path');\r\n        if (!/^.\\//i.test(modulePath)) {\r\n            if (require.resolve && require.resolve.paths) {\r\n                /**\r\n                 * get require paths collection\r\n                 * @type string[]\r\n                 */\r\n                let paths = require.resolve.paths(modulePath);\r\n                //get execution\r\n                let path1 = this.getConfiguration().getExecutionPath();\r\n                //loop directories to parent (like classic require)\r\n                while (path1) {\r\n                    //if path does not exist in paths collection\r\n                    if (paths.indexOf(PathUtils.join(path1,'node_modules'))<0) {\r\n                        //add it\r\n                        paths.push(PathUtils.join(path1,'node_modules'));\r\n                        //and check the next path which is going to be resolved\r\n                        if (path1 === PathUtils.join(path1,'..')) {\r\n                            //if it is the same with the current path break loop\r\n                            break;\r\n                        }\r\n                        //otherwise get parent path\r\n                        path1 = PathUtils.join(path1,'..');\r\n                    }\r\n                    else {\r\n                        //path already exists in paths collection, so break loop\r\n                        break;\r\n                    }\r\n                }\r\n                let finalModulePath = require.resolve(modulePath, {\r\n                    paths:paths\r\n                });\r\n                return require(finalModulePath);\r\n            }\r\n            else {\r\n                return require(modulePath);\r\n            }\r\n        }\r\n        return require(PathUtils.join(this.getConfiguration().getExecutionPath(),modulePath));\r\n    }\r\n}\r\n\r\n/**\r\n * @classdesc\r\n * @extends ModuleLoaderStrategy\r\n */\r\nexport class DefaultModuleLoaderStrategy extends ModuleLoaderStrategy {\r\n    /**\r\n    * @param {ConfigurationBase} config\r\n    */\r\n    constructor(config) {\r\n        super(config);\r\n    }\r\n}\r\n\r\n\r\n","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\nimport _ from 'lodash';\r\n\r\n// eslint-disable-next-line no-unused-vars\r\n// tslint:disable-next-line:no-unused-variable\r\nconst HTML_START_CHAR = '<';\r\nconst HTML_END_CHAR = '>';\r\nconst HTML_FULL_END_STRING = ' />';\r\nconst HTML_SPACE_CHAR = ' ';\r\nconst HTML_ATTR_STRING = '%0=\"%1\"';\r\nconst HTML_START_TAG_STRING = '<%0';\r\nconst HTML_END_TAG_STRING = '</%0>';\r\n\r\n\r\n/**\r\n * @classdesc HtmlWriter class represents a helper class for rendering HTML content.\r\n * @class\r\n * @constructor\r\n */\r\nexport class HtmlWriter {\r\n    constructor() {\r\n        /**\r\n         * @private\r\n         * @type {Array}\r\n         */\r\n        this.bufferedAttributes=[];\r\n        /**\r\n         * @private\r\n         * @type {Array}\r\n         */\r\n        this.bufferedTags = [];\r\n        /**\r\n         * @private\r\n         * @type {String}\r\n         */\r\n        this.buffer = '';\r\n        /**\r\n         * @private\r\n         * @type {Integer}\r\n         */\r\n        this.indent = true;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Writes an attribute to an array of attributes that is going to be used in writeBeginTag function\r\n     * @param {String} name - The name of the HTML attribute\r\n     * @param {String} value - The value of the HTML attribute\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeAttribute(name, value) {\r\n        this.bufferedAttributes.push({name:name, value:value});\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Writes an array of attributes to the output buffer. This attributes are going to be rendered after writeBeginTag or WriteFullBeginTag function call.\r\n     * @param {Array|Object} obj - An array of attributes or an object that represents an array of attributes\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeAttributes(obj) {\r\n        if (obj===null)\r\n            return this;\r\n        if (Array.isArray(obj)) {\r\n            for (let i = 0; i < obj.length; i++) {\r\n                this.bufferedAttributes.push( { name:obj[i].name, value:obj[i].value } );\r\n            }\r\n        }\r\n        else {\r\n            for (let prop in obj)\r\n            {\r\n                if (obj.hasOwnProperty(prop)) {\r\n                    if (obj[prop]!==null) {\r\n                        this.bufferedAttributes.push( { name:prop, value:obj[prop] } );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * @param {String} tag\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeBeginTag(tag) {\r\n        //write <TAG\r\n        if (this.indent)\r\n        {\r\n            //this.buffer += '\\n';\r\n            this.buffer += '\\t'.repeat(this.bufferedTags.length);\r\n        }\r\n        this.buffer += HTML_START_TAG_STRING.replace(/%0/, tag);\r\n        this.bufferedTags.push(tag);\r\n        if (this.bufferedAttributes.length>0)\r\n        {\r\n            let s = '';\r\n            this.bufferedAttributes.forEach(attr => {\r\n                //write attribute='value'\r\n                s += HTML_SPACE_CHAR;\r\n                s += HTML_ATTR_STRING.replace(/%0/,attr.name).replace(/%1/, _.escape(attr.value));\r\n            });\r\n            this.buffer += s;\r\n        }\r\n        this.bufferedAttributes.splice(0,this.bufferedAttributes.length);\r\n        this.buffer += HTML_END_CHAR;\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Writes a full begin HTML tag (e.g <div/>).\r\n     * @param {String} tag\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeFullBeginTag(tag) {\r\n        //write <TAG\r\n        if (this.indent)\r\n        {\r\n            this.buffer += '\\n';\r\n            this.buffer +=_.repeat('\\t', this.bufferedTags.length);\r\n        }\r\n        this.buffer += HTML_START_TAG_STRING.replace(/%0/, tag);\r\n        if (this.bufferedAttributes.length>0)\r\n        {\r\n            let s = '';\r\n            this.bufferedAttributes.forEach( attr => {\r\n                //write attribute='value'\r\n                s += HTML_SPACE_CHAR;\r\n                s += HTML_ATTR_STRING.replace(/%0/,attr.name).replace(/%1/, _.escape(attr.value));\r\n            });\r\n            this.buffer += s;\r\n        }\r\n        this.bufferedAttributes.splice(0,this.bufferedAttributes.length);\r\n        this.buffer += HTML_FULL_END_STRING;\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * Writes an end HTML tag (e.g </div>) based on the current buffered tags.\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeEndTag() {\r\n        const tagsLength = this.bufferedTags ? this.bufferedTags.length : 0;\r\n        if (tagsLength===0)\r\n            return this;\r\n        if (this.indent)\r\n        {\r\n            this.buffer += '\\n';\r\n            this.buffer +=_.repeat('\\t', tagsLength-1);\r\n        }\r\n        this.buffer += HTML_END_TAG_STRING.replace(/%0/,this.bufferedTags[tagsLength-1]);\r\n        this.bufferedTags.splice(tagsLength-1,1);\r\n        return this;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     *\r\n     * @param {String} s\r\n     * @returns {HtmlWriter}\r\n     */\r\n    writeText(s) {\r\n        if (!s)\r\n            return this;\r\n        if (this.indent)\r\n        {\r\n            this.buffer += '\\n';\r\n            this.buffer +=_.repeat('\\t', this.bufferedTags.length);\r\n        }\r\n        this.buffer += _.escape(s);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} s\r\n     * @returns {HtmlWriter}\r\n     */\r\n    write(s) {\r\n        this.buffer += s;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @returns {String}\r\n     */\r\n    toString() {\r\n        return this.buffer;\r\n    }\r\n\r\n    // noinspection JSUnusedGlobalSymbols\r\n    /**\r\n     * @param {function} fn\r\n     */\r\n    writeTo(fn) {\r\n        if (typeof fn === 'function') {\r\n            //call function\r\n            fn(this.buffer);\r\n            //and clear buffer\r\n            this.buffer='';\r\n            //and clear buffered tags\r\n            this.bufferedTags.splice(0,this.bufferedTags.length);\r\n        }\r\n    }\r\n}\r\n","/**\r\n * MOST Web Framework 3.0 Codename Zero Gravity\r\n * Copyright (c) 2014-2019, THEMOST LP All rights reserved\r\n *\r\n * Use of this source code is governed by an BSD-3-Clause license that can be\r\n * found in the LICENSE file at https://themost.io/license\r\n */\r\nimport {AbstractMethodError} from \"./errors\";\r\nimport {AbstractClassError} from \"./errors\";\r\n\r\n/**\r\n *\r\n * @class\r\n * @abstract\r\n * @param {string=} configPath\r\n */\r\nclass IApplication {\r\n    // eslint-disable-next-line no-unused-vars\r\n    constructor(_configPath) {\r\n        if (this.constructor === IApplication.prototype.constructor) {\r\n            throw new AbstractClassError();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Registers an application strategy e.g. an singleton service which to be used in application contextr\r\n     * @param {Function} serviceCtor\r\n     * @param {Function} strategyCtor\r\n     * @returns IApplication\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    useStrategy(serviceCtor, strategyCtor) {\r\n        throw new AbstractMethodError();\r\n    }\r\n\r\n    /**\r\n    * @param {Function} serviceCtor\r\n    * @returns {boolean}\r\n    */\r\n    // eslint-disable-next-line no-unused-vars\r\n    hasStrategy(serviceCtor) {\r\n        throw new AbstractMethodError();\r\n    }\r\n\r\n    /**\r\n     * Gets an application strategy based on the given base service type\r\n     * @param {Function} serviceCtor\r\n     * @return {*}\r\n     */\r\n    // eslint-disable-next-line no-unused-vars\r\n    getStrategy(serviceCtor) {\r\n        throw new AbstractMethodError();\r\n    }\r\n\r\n    /**\r\n     * @returns {ConfigurationBase}\r\n     */\r\n    getConfiguration() {\r\n        throw new AbstractMethodError();\r\n    }\r\n}\r\n\r\n/**\r\n *\r\n * @class\r\n * @abstract\r\n * @param {IApplication} app\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nclass IApplicationService {\r\n    constructor(app) {\r\n        if (this.constructor === IApplicationService.prototype.constructor) {\r\n            throw new AbstractClassError();\r\n        }\r\n    }\r\n    /**\r\n     * @returns {IApplication}\r\n     */\r\n    getApplication() {\r\n        throw new AbstractMethodError();\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @classdesc Represents an application service\r\n * @class\r\n */\r\n// eslint-disable-next-line no-unused-vars\r\nclass ApplicationService extends IApplication {\r\n    /**\r\n     * @param {IApplication} app\r\n     */\r\n    constructor(app) {\r\n        super(app);\r\n        Object.defineProperty(this, '_app', {\r\n            enumerable: false,\r\n            writable: false,\r\n            value: app\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @returns {IApplication}\r\n     */\r\n    getApplication() {\r\n        return this._app;\r\n    }\r\n}\r\n\r\nexport {IApplication};\r\nexport {IApplicationService};\r\nexport {ApplicationService};\r\n"],"names":["SequentialEventEmitter","event","_args","callback","listeners","Error","argsAndCallback","concat","Array","prototype","slice","call","arguments","length","TypeError","applyEachSeries","apply","EventEmitter","Errors","statusCode","title","message","module","AbstractMethodError","msg","captureStackTrace","constructor","AbstractClassError","CodedError","code","FileNotFoundError","HttpError","status","innerMessage","finalStatus","Number","isNumber","err","errors","find","x","hasOwnProperty","Object","assign","HttpBadRequestError","HttpNotFoundError","HttpMethodNotAllowedError","HttpUnauthorizedError","HttpNotAcceptableError","HttpRequestTimeoutError","HttpConflictError","HttpTokenExpiredError","HttpTokenRequiredError","HttpForbiddenError","HttpServerError","HttpServiceUnavailable","DataError","model","field","additionalData","NotNullError","DataNotFoundError","AccessDeniedError","UniqueConstraintError","IS_NODE","toString","process","UUID_CHARS","HEX_CHARS","STRIP_COMMENTS","DATE_TIME_REGEX","BOOLEAN_TRUE_REGEX","BOOLEAN_FALSE_REGEX","NULL_REGEX","UNDEFINED_REGEX","INT_REGEX","FLOAT_REGEX","GUID_REGEX","LOG_LEVELS","error","warn","info","verbose","debug","UnknownPropertyDescriptor","obj","name","defineProperty","configurable","enumerable","get","set","value","LangUtils","ctor","superCtor","utilModule","util","require","inherits","create","writable","setPrototypeOf","__proto__","super_","fn","fnStr","replace","result","indexOf","match","parseInt","parseFloat","Date","parse","origin","expr","options","convertValues","exec","descriptor","expr1","test","isArray","substr","index","extend","re","typedValue","convert","push","form","keys","forEach","key","any","Args","notNull","res","ArgumentError","arg","isNaN","bind","notNumber","TextUtils","md5","md5module","window","toUTCString","JSON","stringify","crypto","createHash","update","digest","cryptoModule","sha1","sha256","chars","uuid","r","i","Math","random","join","TraceLogger","colors","level","env","NODE_ENV","check","data","args","writeError","write","sprintf","text","console","log","timestamp","toUpperCase","TraceUtils","logger","_logger","_data","RandomUtils","str","randomInt","min","max","floor","NumberUtils","s","num","a","charCodeAt","out","String","fromCharCode","PathUtils","_part","pathModule","path","parts","l","split","newParts","part1","pop","unshift","filter","stack","map","Base26Number","thisValue","toBase26","Guid","_value","newUUID","b","toLowerCase","ConfigurationBase","configPath","cwd","_configurationPath","_executionPath","useStrategy","ModuleLoaderStrategy","DefaultModuleLoaderStrategy","configSourcePath","_config","p","_","at","isObject","configStrategyCtor","strategyCtor","notFunction","_strategies","_currentConfiguration","configuration","hasStrategy","ConfigurationStrategy","config","modulePath","notEmpty","resolve","paths","path1","getConfiguration","getExecutionPath","finalModulePath","HTML_END_CHAR","HTML_FULL_END_STRING","HTML_SPACE_CHAR","HTML_ATTR_STRING","HTML_START_TAG_STRING","HTML_END_TAG_STRING","HtmlWriter","bufferedAttributes","bufferedTags","buffer","indent","prop","tag","repeat","attr","escape","splice","tagsLength","IApplication","_configPath","serviceCtor","IApplicationService","app","ApplicationService","_app"],"mappings":"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"}